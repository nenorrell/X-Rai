<p align="center">
  <img src="xrai.png" alt="X-Rai" width="200">
</p>

# X-Rai

**Token-efficient PostgreSQL schema snapshots for LLMs.**

X-Rai extracts your PostgreSQL schema into a compact, deterministic format that fits cleanly into LLM context windows. Generate once, reuse everywhere - no live DB access, no repeated introspection.

---

## Why X-Rai

LLMs perform better when they have full schema context — but raw DDL is noisy, expensive, and inconsistent.

X-Rai gives you:

- Complete schema visibility (tables, columns, relations, constraints)
- Predictable, token-efficient output
- Static artifacts you can cache, commit, and share
- One-command setup via Docker

---

## Quick Start

> Requires Docker

### Zero install (recommended)

```bash
bash -c "$(curl -fsSL https://raw.githubusercontent.com/nenorrell/xrai/master/run.sh)" _ generate \
  --dsn "postgres://user:pass@host.docker.internal:5432/mydb" \
  --output ./schema-output
```

### Docker run

```bash
docker run --rm -it \
  -v "$(pwd)/schema-output:/output" \
  --add-host=host.docker.internal:host-gateway \
  ghcr.io/nenorrell/xrai:latest generate \
  --dsn "postgres://user:pass@host.docker.internal:5432/mydb" \
  --output /output
```

---

## Using the Output

X-Rai generates a `.xrai/llms.txt` file designed for direct use in LLM prompts. No runtime DB access required.

### Example LLM Prompt

```
You are a senior PostgreSQL engineer.

Below is the full database schema context generated by X-Rai.
Use it as the source of truth when answering.

<SCHEMA_CONTEXT>
[paste contents of .xrai/llms.txt here]
</SCHEMA_CONTEXT>

Task:
Write an efficient SQL query to fetch the 10 most recently active users,
including their last login timestamp and the total number of orders they’ve placed.
```

---

## CLI Flags

```
--dsn                     PostgreSQL connection string (required)
--output, -o              Output directory (required)
--schemas                 Comma-separated schemas (default: "public")
--stats                   Include table/column statistics
--include-views           Include views
--include-routines        Include functions/procedures
--redact-comments         Remove comments
--redact-definitions      Remove SQL definitions
```

---

## Development

```bash
git clone https://github.com/nenorrell/X-Rai.git
cd xrai

make build
make run
make test
make deploy
```
